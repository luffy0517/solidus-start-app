<% max_level = Spree::Config[:max_level_in_taxons_menu] || 1 %>

<nav id="taxonomies">
  <% cache [I18n.locale, taxonomies, max_level] do %>
    <% taxonomies.each do |taxonomy| %>
      <% cache [I18n.locale, taxonomy, @taxon, max_level] do %>
        <h6>
          <%= t('spree.shop_by_taxonomy', taxonomy: taxonomy.name) %>
        </h6>
        <%= taxons_tree(taxonomy.root, @taxon, max_level) %>
      <% end %>
    <% end %>
  <% end %>
</nav>
